# --
# AgentTicketFreeText.dtl - provides HTML form for free text mask
# Copyright (C) 2001-2009 OTRS AG, http://otrs.org/
# --
# $Id: AgentTicketFreeText.dtl,v 1.30.2.4 2009/12/08 09:15:08 mg Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

<!-- dtl:block:Properties -->
<script language="JavaScript" type="text/javascript">
<!--


// [MS for FULL (inizio) ]

function MS_Populate_Wind_VARS() 
{
	var MS_sep = "#!#";
	
	// Categorie ALARM per Wind 
	var MS_Category_Alarm_PM_Wind = '$Env{"MS_Category_Alarm_PM_Wind"}';
	MS_Category_Alarm_PM_Wind_ARRAY = MS_Category_Alarm_PM_Wind.split(MS_sep);
	MS_Category_Alarm_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	
	// Categorie ALARM da Wind a PM
	var MS_Category_Alarm_Wind_PM = '$Env{"MS_Category_Alarm_Wind_PM"}';
	MS_Category_Alarm_Wind_PM_ARRAY = MS_Category_Alarm_Wind_PM.split(MS_sep);
	MS_Category_Alarm_Wind_PM_ARRAY.sort(); //ordino alfabeticamente
	
	// Categorie Incident per Wind 
	var MS_Category_Incident_PM_Wind = '$Env{"MS_Category_Incident_PM_Wind"}';
	MS_Category_Incident_PM_Wind_ARRAY = MS_Category_Incident_PM_Wind.split(MS_sep);
	MS_Category_Incident_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	
	// AMBITO TT per Wind 
	var MS_AmbitoTT_PM_Wind = '$Env{"MS_AmbitoTT_PM_Wind"}';
	MS_AmbitoTT_PM_Wind_ARRAY = MS_AmbitoTT_PM_Wind.split(MS_sep);
	MS_AmbitoTT_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	
	// Tipo Linea per Wind 
	var MS_TipoLinea_PM_Wind = '$Env{"MS_TipoLinea_PM_Wind"}';
	MS_TipoLinea_PM_Wind_ARRAY = MS_TipoLinea_PM_Wind.split(MS_sep);
	MS_TipoLinea_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	
	// MNP Type per Wind 
	var MS_MNPType_PM_Wind = '$Env{"MS_MNPType_PM_Wind"}';
	MS_MNPType_PM_Wind_ARRAY = MS_MNPType_PM_Wind.split(MS_sep);
	MS_MNPType_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	
	// Marcaggio per Wind 
	var MS_Marcaggio_PM_Wind = '$Env{"MS_Marcaggio_PM_Wind"}';
	MS_Marcaggio_PM_Wind_ARRAY = MS_Marcaggio_PM_Wind.split(MS_sep);
	MS_Marcaggio_PM_Wind_ARRAY.sort(); //ordino alfabeticamente


   // i nuovi stati
   MS_ticketStateID_Sospeso = '$Env{"MS_ticketStateID_Sospeso"}';
   MS_ticketStateID_RisoltoNRI = '$Env{"MS_ticketStateID_RisoltoNRI"}';
   MS_ticketStateID_RisoltoNoACT = '$Env{"MS_ticketStateID_RisoltoNoACT"}';
   
   
   // i nuovi tipi di ticket
   MS_ticketTypeID_IncidentToWind = '$Env{"MS_ticketTypeID_IncidentToWind"}';
   MS_ticketTypeID_IncidentToPM = '$Env{"MS_ticketTypeID_IncidentToPM"}';
   MS_ticketTypeID_IncidentToEricsson = '$Env{"MS_ticketTypeID_IncidentToEricsson"}';
   MS_ticketTypeID_AlarmFromWind = '$Env{"MS_ticketTypeID_AlarmFromWind"}';
   MS_ticketTypeID_AlarmToWind = '$Env{"MS_ticketTypeID_AlarmToWind"}';
   MS_ticketTypeID_AlarmToEricsson = '$Env{"MS_ticketTypeID_AlarmToEricsson"}';
   MS_ticketTypeID_AlarmToPM = '$Env{"MS_ticketTypeID_AlarmToPM"}';
   
   
   
   
   // valori specifici del ticket corrente
	MS_current_ticket_freetime1 = '$Env{"MS_current_ticket_freetime1"}';
	MS_current_ticket_freetime2 = '$Env{"MS_current_ticket_freetime2"}';
	MS_current_ticket_freetime3 = '$Env{"MS_current_ticket_freetime3"}';
	MS_current_ticket_vf_closing_code = '$Env{"MS_current_ticket_vf_closing_code"}';
	MS_current_ticket_vf_error_message = '$Env{"MS_current_ticket_vf_error_message"}';
	MS_current_ticket_typeID = '$Env{"MS_current_ticket_typeID"}';
	MS_current_ticket_freetext15 = '$Env{"MS_current_ticket_freetext15"}';
	MS_current_ticket_freetext16 = '$Env{"MS_current_ticket_freetext16"}';
	
	MS_current_ticket_WIND_FREETEXT2_SPLITTED = '$Env{"MS_current_ticket_WIND_FREETEXT2_SPLITTED"}';
	MS_current_ticket_WIND_MSISDN = '$Env{"MS_current_ticket_WIND_MSISDN"}';
	MS_current_ticket_WIND_ID_LINEA = '$Env{"MS_current_ticket_WIND_ID_LINEA"}';
	
	MS_current_ticket_WIND_FREETEXT3_SPLITTED = '$Env{"MS_current_ticket_WIND_FREETEXT3_SPLITTED"}';
	MS_current_ticket_WIND_IMSI = '$Env{"MS_current_ticket_WIND_IMSI"}';
	MS_current_ticket_WIND_ICCID = '$Env{"MS_current_ticket_WIND_ICCID"}';
	MS_current_ticket_WIND_IMEI = '$Env{"MS_current_ticket_WIND_IMEI"}';
	
	MS_current_ticket_WIND_FREETEXT10_SPLITTED = '$Env{"MS_current_ticket_WIND_FREETEXT10_SPLITTED"}';
	MS_current_ticket_WIND_AMBITOTT = '$Env{"MS_current_ticket_WIND_AMBITOTT"}';
	MS_current_ticket_WIND_TIPO_LINEA = '$Env{"MS_current_ticket_WIND_TIPO_LINEA"}';
	MS_current_ticket_WIND_MNP_TYPE = '$Env{"MS_current_ticket_WIND_MNP_TYPE"}';
	
	MS_current_ticket_WIND_FREETEXT11_SPLITTED = '$Env{"MS_current_ticket_WIND_FREETEXT11_SPLITTED"}';
	MS_current_ticket_WIND_Comune = '$Env{"MS_current_ticket_WIND_Comune"}';
	MS_current_ticket_WIND_Provincia = '$Env{"MS_current_ticket_WIND_Provincia"}';
	MS_current_ticket_WIND_Indirizzo = '$Env{"MS_current_ticket_WIND_Indirizzo"}';
	MS_current_ticket_WIND_CAP = '$Env{"MS_current_ticket_WIND_CAP"}';
	
	
	MS_current_ticket_FREETEXT2 = '$QData{"TicketFreeText2"}';
	MS_current_ticket_FREETEXT3 = '$QData{"TicketFreeText3"}';
	MS_current_ticket_FREETEXT10 = '$QData{"TicketFreeText10"}';
	MS_current_ticket_FREETEXT11 = '$QData{"TicketFreeText11"}';
   
}



function MS_Populate_Wind_Fields() 
{
	//alert('MS_Populate_Wind_Fields: ok');

	MS_Populate_Wind_VARS();

	var x = '';

	var MS_sep = "#!#";
	var MS_category_prefix_INCIDENT = "WIND_ERICSSON (INCIDENT) - ";
	var MS_category_prefix_ALARM = "WIND_ERICSSON (ALARM) - ";
	var MS_category_prefix_ALARM_to_PM = "WIND_ERICSSON (ALARM to PM) - ";
	



	// Categorie ALARM per Wind 
	//var MS_Category_Alarm_PM_Wind = '$Env{"MS_Category_Alarm_PM_Wind"}';
	//var MS_Category_Alarm_PM_Wind_ARRAY = MS_Category_Alarm_PM_Wind.split(MS_sep);
	//MS_Category_Alarm_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("TicketFreeText15");
	for (var i=0;i<MS_Category_Alarm_PM_Wind_ARRAY.length;i++)
	{
		var option = document.createElement("option");
		option.value = MS_Category_Alarm_PM_Wind_ARRAY[i];
		option.text = MS_category_prefix_ALARM + MS_Category_Alarm_PM_Wind_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}


	// Categorie ALARM da Wind a PM
	//var MS_Category_Alarm_Wind_PM = '$Env{"MS_Category_Alarm_Wind_PM"}';
	//var MS_Category_Alarm_Wind_PM_ARRAY = MS_Category_Alarm_Wind_PM.split(MS_sep);
	//MS_Category_Alarm_Wind_PM_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("TicketFreeText15");
	for (var i=0;i<MS_Category_Alarm_Wind_PM_ARRAY.length;i++)
	{
		var option = document.createElement("option");
		option.value = MS_Category_Alarm_Wind_PM_ARRAY[i];
		option.text = MS_category_prefix_ALARM_to_PM + MS_Category_Alarm_Wind_PM_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}
	

	// Categorie Incident per Wind 
	//var MS_Category_Incident_PM_Wind = '$Env{"MS_Category_Incident_PM_Wind"}';
	//var MS_Category_Incident_PM_Wind_ARRAY = MS_Category_Incident_PM_Wind.split(MS_sep);
	//MS_Category_Incident_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("TicketFreeText15");
	for (var i=0;i<MS_Category_Incident_PM_Wind_ARRAY.length;i++)
	{
		//alert("Categoria " + i + ": " + MS_Category_Incident_PM_Wind_ARRAY[i]);
		var option = document.createElement("option");
		option.value = MS_Category_Incident_PM_Wind_ARRAY[i];
		option.text = MS_category_prefix_INCIDENT + MS_Category_Incident_PM_Wind_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}
	
	//posizioniamo la categoria su quella corretta
	x.value = MS_current_ticket_freetext15;
	

	

	// AMBITO TT per Wind 
	//var MS_AmbitoTT_PM_Wind = '$Env{"MS_AmbitoTT_PM_Wind"}';
	//var MS_AmbitoTT_PM_Wind_ARRAY = MS_AmbitoTT_PM_Wind.split(MS_sep);
	//MS_AmbitoTT_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("WIND_AMBITOTT");
	for (var i=0;i<MS_AmbitoTT_PM_Wind_ARRAY.length;i++)
	{
		var option = document.createElement("option");
		option.value = MS_AmbitoTT_PM_Wind_ARRAY[i];
		option.text = MS_AmbitoTT_PM_Wind_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}	


	// Tipo Linea per Wind 
	//var MS_TipoLinea_PM_Wind = '$Env{"MS_TipoLinea_PM_Wind"}';
	//var MS_TipoLinea_PM_Wind_ARRAY = MS_TipoLinea_PM_Wind.split(MS_sep);
	//MS_TipoLinea_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("WIND_TIPOLINEA");
	for (var i=0;i<MS_TipoLinea_PM_Wind_ARRAY.length;i++)
	{
		var option = document.createElement("option");
		option.value = MS_TipoLinea_PM_Wind_ARRAY[i];
		option.text = MS_TipoLinea_PM_Wind_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}	


	// MNP Type per Wind 
	//var MS_MNPType_PM_Wind = '$Env{"MS_MNPType_PM_Wind"}';
	//var MS_MNPType_PM_Wind_ARRAY = MS_MNPType_PM_Wind.split(MS_sep);
	//MS_MNPType_PM_Wind_ARRAY.sort(); //ordino alfabeticamente
	x=document.getElementById("WIND_MNPTYPE");
	for (var i=0;i<MS_MNPType_PM_Wind_ARRAY.length;i++)
	{
		var option = document.createElement("option");
		option.value = MS_MNPType_PM_Wind_ARRAY[i];
		option.text = MS_MNPType_PM_Wind_ARRAY[i];
		try
		{
		  // for IE earlier than version 8
		  x.add(option,x.options[null]);
		}
		catch (e)
		{
		  x.add(option,null);
		}
	}


	//aggiungo evento al Type dei ticket
	//x=document.getElementById("TypeID");
	//x.setAttribute("onchange", function(){MS_Check_if_is_for_Wind();});




	var id_tipo = document.getElementById("TypeID").value;
	var nome_tipo = document.getElementById("TypeID").title;

//	//ambito Full o possibile ambito Full
//	if ( MS_current_ticket_typeID == MS_ticketTypeID_IncidentToWind ||
//				MS_current_ticket_typeID == MS_ticketTypeID_IncidentToPM ||
//				MS_current_ticket_typeID == MS_ticketTypeID_IncidentToEricsson ||
//			
//				MS_current_ticket_typeID == MS_ticketTypeID_AlarmToWind ||
//				MS_current_ticket_typeID == MS_ticketTypeID_AlarmToEricsson ||
//				MS_current_ticket_typeID == MS_ticketTypeID_AlarmToPM 
//			
//				|| nome_tipo == "SR-Alarm/Reclamo" 
//				|| nome_tipo == "SR-Escalation"
//				|| nome_tipo == "SR-Sollecito"
//				|| nome_tipo == "PR Master" 
//		) 
//	{
//
//	}



    var normalSeparator = '|'; 
	var specialSeparator = '_#_'; 
	var pos = -1;
	
	if(MS_current_ticket_FREETEXT2 != '')
	{
		pos = MS_current_ticket_WIND_MSISDN.indexOf("|"); 
		if(MS_current_ticket_WIND_FREETEXT2_SPLITTED == 1 && pos == -1) //spacchettamento corretto 
		{
			//document.getElementById("TicketFreeText2").value = MS_current_ticket_WIND_MSISDN;
			document.getElementsByName('TicketFreeText2')[0].value = MS_current_ticket_WIND_MSISDN;
			document.getElementById("WIND_IDLINEA").value = MS_current_ticket_WIND_ID_LINEA;
		}
	}


	if(MS_current_ticket_FREETEXT3 != '')
	{
		pos = MS_current_ticket_WIND_IMSI.indexOf("|"); 
		if(MS_current_ticket_WIND_FREETEXT3_SPLITTED == 1 && pos == -1) //spacchettamento corretto
		{
			//document.getElementById("TicketFreeText3").value = MS_current_ticket_WIND_IMSI + '|' + MS_current_ticket_WIND_ICCID;
			document.getElementsByName('TicketFreeText3')[0].value = MS_current_ticket_WIND_IMSI + '|' + MS_current_ticket_WIND_ICCID;
			document.getElementById("WIND_IMEI").value = MS_current_ticket_WIND_IMEI;
		}
	}	



	if(MS_current_ticket_FREETEXT10 != '')
	{
		pos = MS_current_ticket_WIND_AMBITOTT.indexOf("|"); 
		if(MS_current_ticket_WIND_FREETEXT10_SPLITTED == 1 && pos == -1) //spacchettamento corretto 
		{
			//document.getElementById("TicketFreeText10").value = MS_current_ticket_WIND_IMSI + '|' + MS_current_ticket_WIND_ICCID;
			document.getElementById("WIND_AMBITOTT").value = MS_current_ticket_WIND_AMBITOTT;
			document.getElementById("WIND_TIPOLINEA").value = MS_current_ticket_WIND_TIPO_LINEA;
			document.getElementById("WIND_MNPTYPE").value = MS_current_ticket_WIND_MNP_TYPE;
		}
	}	



	if(MS_current_ticket_FREETEXT11 != '')
	{
		pos = MS_current_ticket_WIND_Comune.indexOf("|"); 
		if(MS_current_ticket_WIND_FREETEXT11_SPLITTED == 1 && pos == -1) //spacchettamento corretto 
		{
			//document.getElementById("TicketFreeText10").value = MS_current_ticket_WIND_IMSI + '|' + MS_current_ticket_WIND_ICCID;
			document.getElementById("WIND_COMUNE").value = MS_current_ticket_WIND_Comune;
			document.getElementById("WIND_PROVINCIA").value = MS_current_ticket_WIND_Provincia;
			document.getElementById("WIND_INDIRIZZO").value = MS_current_ticket_WIND_Indirizzo;
			document.getElementById("WIND_CAP").value = MS_current_ticket_WIND_CAP;
		}
	}
	
	




	if(!document.compose.TicketFreeText10)
	{
		var freekey10 = document.createElement("input"); //input element, text
		freekey10.setAttribute('type',"hidden");
		freekey10.setAttribute('name',"TicketFreeKey10");
		freekey10.setAttribute('id',"TicketFreeKey10");
		freekey10.setAttribute("value", "VF Servizio|VF Descrizione");	
		document.compose.appendChild(freekey10); // put it into the DOM
	
		var freetext10 = document.createElement("input"); //input element, text
		freetext10.setAttribute('type',"hidden");
		freetext10.setAttribute('name',"TicketFreeText10");
		freetext10.setAttribute('id',"TicketFreeText10");
		freetext10.setAttribute("value", "");
		document.compose.appendChild(freetext10); // put it into the DOM
	}
	
	if(!document.compose.TicketFreeText11)
	{
		var freekey11 = document.createElement("input"); //input element, text
		freekey11.setAttribute('type',"hidden");
		freekey11.setAttribute('name',"TicketFreeKey11");
		freekey11.setAttribute('id',"TicketFreeKey11");
		freekey11.setAttribute("value", "VF Citta|VF Provincia|VF Via");	
		document.compose.appendChild(freekey11); // put it into the DOM	

		var freetext11 = document.createElement("input"); //input element, text
		freetext11.setAttribute('type',"hidden");
		freetext11.setAttribute('name',"TicketFreeText11");
		freetext11.setAttribute('id',"TicketFreeText11");
		freetext11.setAttribute("value", "");
		document.compose.appendChild(freetext11); // put it into the DOM
	}
		
//<input type="hidden" name="TicketFreeKey14" value="PI Ticket ID"/>
	
}





// var globali
var MS_Category_Alarm_PM_Wind_ARRAY = '';
var MS_Category_Alarm_Wind_PM_ARRAY = '';
var MS_Category_Incident_PM_Wind_ARRAY = '';
var MS_AmbitoTT_PM_Wind_ARRAY = '';
var MS_TipoLinea_PM_Wind_ARRAY = '';
var MS_MNPType_PM_Wind_ARRAY = '';
var MS_Marcaggio_PM_Wind_ARRAY = '';

// i nuovi stati
var MS_ticketStateID_Sospeso = '';
var MS_ticketStateID_RisoltoNRI = '';
var MS_ticketStateID_RisoltoNoACT = '';
   
   
// i nuovi tipi di ticket
var MS_ticketTypeID_IncidentToWind = '';
var MS_ticketTypeID_IncidentToPM = '';
var MS_ticketTypeID_IncidentToEricsson = '';
var MS_ticketTypeID_AlarmFromWind = '';
var MS_ticketTypeID_AlarmToWind = '';
var MS_ticketTypeID_AlarmToEricsson = '';
var MS_ticketTypeID_AlarmToPM = '';


// valori specifici del ticket corrente
var MS_current_ticket_freetime1 = '';
var MS_current_ticket_freetime2 = '';
var MS_current_ticket_freetime3 = '';
var MS_current_ticket_vf_closing_code = '';
var MS_current_ticket_vf_error_message = '';
var MS_current_ticket_typeID = '';
var MS_current_ticket_freetext15 = '';
var MS_current_ticket_freetext16 = '';



var MS_current_ticket_WIND_FREETEXT2_SPLITTED = '';
var MS_current_ticket_WIND_MSISDN = '';
var MS_current_ticket_WIND_ID_LINEA = '';
	
var MS_current_ticket_WIND_FREETEXT3_SPLITTED = '';
var MS_current_ticket_WIND_IMSI = '';
var MS_current_ticket_WIND_ICCID = '';
var MS_current_ticket_WIND_IMEI = '';
	
var MS_current_ticket_WIND_FREETEXT10_SPLITTED = '';
var MS_current_ticket_WIND_AMBITOTT = '';
var MS_current_ticket_WIND_TIPO_LINEA = '';
var MS_current_ticket_WIND_MNP_TYPE = '';
	
var MS_current_ticket_WIND_FREETEXT11_SPLITTED = '';
var MS_current_ticket_WIND_Comune = '';
var MS_current_ticket_WIND_Provincia = '';
var MS_current_ticket_WIND_Indirizzo = '';
var MS_current_ticket_WIND_CAP = '';

var MS_current_ticket_FREETEXT2 = '';
var MS_current_ticket_FREETEXT3 = '';
var MS_current_ticket_FREETEXT10 = '';
var MS_current_ticket_FREETEXT11 = '';



window.onload = MS_Populate_Wind_Fields;








function MS_Wind_Validate() 
{
	var rit = false;
	
    if (document.compose.TypeID && document.compose.TypeID.value == MS_ticketTypeID_AlarmFromWind) //Alarm da Wind
    {
        alert('$JSText{"Non puoi creare un *Alarm da Wind* "}');
        document.compose.TypeID.focus();
    }  
    else if (document.compose.TypeID && 
    			(document.compose.TypeID.value == MS_ticketTypeID_IncidentToWind ||
    			document.compose.TypeID.value == MS_ticketTypeID_IncidentToPM ||
    			document.compose.TypeID.value == MS_ticketTypeID_IncidentToEricsson )
    		) //Incident per Wind, per PM o per Ericsson
    {
    	if(document.compose.TicketFreeText15)
    	{
    		var category_ok = false;
			for (var i=0;i<MS_Category_Incident_PM_Wind_ARRAY.length;i++)
			{
				if(document.compose.TicketFreeText15.value == MS_Category_Incident_PM_Wind_ARRAY[i])
				{
					category_ok = true;
					break;
				}
			}
			
			if(category_ok)
			{
				if(document.compose.WIND_AMBITOTT)
				{
					var ambito_ok = false;
					for (var i=0;i<MS_AmbitoTT_PM_Wind_ARRAY.length;i++)
					{
						if(document.compose.WIND_AMBITOTT.value == MS_AmbitoTT_PM_Wind_ARRAY[i])
						{
							ambito_ok = true;
							break;
						}
					}
					
					if(ambito_ok)
					{   					
						rit = true;
					}
					else
					{
						alert('$JSText{"Ambito TT non corretto"}');
						document.compose.WIND_AMBITOTT.focus();						
					}
				}
				else
				{
					alert('$JSText{"Devi definire un Ambito TT"}');
					document.compose.WIND_AMBITOTT.focus();				
				}
			}
			else
			{
    			alert('$JSText{"Categoria con valore non possibile per questa tipologia di ticket"}');
    			document.compose.TicketFreeText15.focus();			
			}
    	}
    	else
    	{
    		alert('$JSText{"Devi definire una Categoria"}');
    		document.compose.TicketFreeText15.focus();
    	}
    } 
    else if (document.compose.TypeID && 
    			(document.compose.TypeID.value == MS_ticketTypeID_AlarmToWind ||
    			document.compose.TypeID.value == MS_ticketTypeID_AlarmToPM ||
    			document.compose.TypeID.value == MS_ticketTypeID_AlarmToEricsson )
    		) //ALARM per Wind, per PM o per Ericsson
    {
    	if(document.compose.TicketFreeText15)
    	{
    		var category_ok = false;
			for (var i=0;i<MS_Category_Alarm_PM_Wind_ARRAY.length;i++)
			{
				if(document.compose.TicketFreeText15.value == MS_Category_Alarm_PM_Wind_ARRAY[i])
				{
					category_ok = true;
					break;
				}
			}
			
			if(category_ok)
			{
				if(document.compose.WIND_AMBITOTT)
				{
					var ambito_ok = false;
					for (var i=0;i<MS_AmbitoTT_PM_Wind_ARRAY.length;i++)
					{
						if(document.compose.WIND_AMBITOTT.value == MS_AmbitoTT_PM_Wind_ARRAY[i])
						{
							ambito_ok = true;
							break;
						}
					}
					
					if(ambito_ok)
					{
						rit = true;
					}
					else
					{
						alert('$JSText{"Ambito TT non corretto"}');
						document.compose.WIND_AMBITOTT.focus();						
					}
				}
				else
				{
					alert('$JSText{"Devi definire un Ambito TT"}');
					document.compose.WIND_AMBITOTT.focus();				
				}
			}
			else
			{
    			alert('$JSText{"Categoria con valore non possibile per questa tipologia di ticket"}');
    			document.compose.TicketFreeText15.focus();			
			}
    	}
    	else
    	{
    		alert('$JSText{"Devi definire una Categoria"}');
    		document.compose.TicketFreeText15.focus();
    	}
    } 
    else
    {
    	rit = true;
    }
 
 
    /*      
    WIND_IMEI
    WIND_IDLINEA
    WIND_AMBITOTT
    WIND_TIPOLINEA
    WIND_MNPTYPE
    
    WIND_INDIRIZZO
    WIND_COMUNE
    WIND_PROVINCIA
    WIND_CAP
    */ 
    
    var normalSeparator = '|'; 
	var specialSeparator = '_#_'; 
    
    if(document.compose.TicketFreeText10 && document.compose.TicketFreeText10.value != '') // VF_Servizio|VF_Descrizione
    {
    	if( (document.compose.WIND_AMBITOTT && document.compose.WIND_AMBITOTT.value != '') ||
    		(document.compose.WIND_TIPOLINEA && document.compose.WIND_TIPOLINEA.value != '') ||
    		(document.compose.WIND_MNPTYPE && document.compose.WIND_MNPTYPE.value != '')
    	    )
    	{
    		alert('$JSText{"Non puoi valorizzare contemporaneamente VF_Servizio|VF_Descrizione e Ambito TT, Tipo Linea, MNP Type "}');
    		rit = false;
    		document.compose.TicketFreeText10.focus();    	
    	}
    }
    else if( (document.compose.WIND_AMBITOTT && document.compose.WIND_AMBITOTT.value != '') ||
    		(document.compose.WIND_TIPOLINEA && document.compose.WIND_TIPOLINEA.value != '') ||
    		(document.compose.WIND_MNPTYPE && document.compose.WIND_MNPTYPE.value != '')
    	    )
    {
		if(!document.compose.TicketFreeText10)
		{
			var freetext10 = document.createElement("input"); //input element, text
			freetext10.setAttribute('type',"hidden");
			freetext10.setAttribute('name',"TicketFreeText10");
			freetext10.setAttribute('id',"TicketFreeText10");
			document.compose.appendChild(freetext10); // put it into the DOM
		}
		
		document.compose.TicketFreeText10.value = document.compose.WIND_AMBITOTT.value + normalSeparator + document.compose.WIND_TIPOLINEA.value + specialSeparator + document.compose.WIND_MNPTYPE.value;
		
    }




    if(document.compose.TicketFreeText11 && document.compose.TicketFreeText11.value != '') // VF_Citta|VF_Provincia|VF_Via
    {
    	if( (document.compose.WIND_INDIRIZZO && document.compose.WIND_INDIRIZZO.value != '') ||
    		(document.compose.WIND_COMUNE && document.compose.WIND_COMUNE.value != '') ||
    		(document.compose.WIND_PROVINCIA && document.compose.WIND_PROVINCIA.value != '') || 
    		(document.compose.WIND_CAP && document.compose.WIND_CAP.value != '')
    	    )
    	{
    		alert('$JSText{"Non puoi valorizzare contemporaneamente VF_Citta|VF_Provincia|VF_Via e i campi indirizzo previsti per Wind "}');
    		rit = false;
    		document.compose.TicketFreeText11.focus();    	
    	}
    }
    else if( (document.compose.WIND_INDIRIZZO && document.compose.WIND_INDIRIZZO.value != '') ||
    		(document.compose.WIND_COMUNE && document.compose.WIND_COMUNE.value != '') ||
    		(document.compose.WIND_PROVINCIA && document.compose.WIND_PROVINCIA.value != '') || 
    		(document.compose.WIND_CAP && document.compose.WIND_CAP.value != '')
    	    )
    {
		if(!document.compose.TicketFreeText11)
		{
			var freetext11 = document.createElement("input"); //input element, text
			freetext11.setAttribute('type',"hidden");
			freetext11.setAttribute('name',"TicketFreeText11");
			freetext11.setAttribute('id',"TicketFreeText11");
			document.compose.appendChild(freetext11); // put it into the DOM
		}
		
		document.compose.TicketFreeText11.value = document.compose.WIND_COMUNE.value + normalSeparator + document.compose.WIND_PROVINCIA.value + normalSeparator + document.compose.WIND_INDIRIZZO.value + specialSeparator + document.compose.WIND_CAP.value;
		
    }






    if(document.compose.TicketFreeText3 && document.compose.TicketFreeText3.value != '') // IMSI|ICCID
    {
    	if( (document.compose.WIND_IMEI && document.compose.WIND_IMEI.value != '') )
    	{
    		var n = document.compose.TicketFreeText3.value.indexOf("|"); 
    		
    		if(n == -1) // separatore non trovato
    		{
    			document.compose.TicketFreeText3.value = document.compose.TicketFreeText3.value + normalSeparator + specialSeparator + document.compose.WIND_IMEI.value;
    		}
    		else
    		{
    			document.compose.TicketFreeText3.value = document.compose.TicketFreeText3.value + specialSeparator + document.compose.WIND_IMEI.value;
    		}
    	}
    }
    else if( (document.compose.WIND_IMEI && document.compose.WIND_IMEI.value != '') )
    {		
		document.compose.TicketFreeText3.value = normalSeparator + specialSeparator + document.compose.WIND_IMEI.value;
    }


    
    return rit;
}

// [MS for FULL (fine) ]






function submit_compose() {
    if (document.compose.TypeID && document.compose.TypeID.value == "") {
        alert('$JSText{"Ticket Type is required!"}');
        document.compose.TypeID.focus();
        return false;
    }
<!-- dtl:block:NoteJs -->
    // if RichText is enabled, update the hidden textarea now for the body content check to work correctly
    if (typeof RichTextUpdateLinkedField == 'function') {
        RichTextUpdateLinkedField();
    }

    if (document.compose.Subject.value == "") {
        alert('$JSText{"A message should have a subject!"}');
        document.compose.Subject.focus();
        return false;
    }
    else if (document.compose.Body.value == "") {
        alert('$JSText{"A message should have a body!"}');
        if (typeof RichTextUpdateLinkedField == 'function') {
            RichTextFocus();
        }
        else {
            document.compose.Body.focus();
        }
        return false;
    }
<!-- dtl:block:NoteJs -->
<!-- dtl:block:TicketFreeTextCheckJs -->
    if (document.compose.$Data{"TicketFreeTextField"}.value == "") {
        alert('$JSText{"A required field is:"} ' + document.compose.$Data{"TicketFreeKeyField"}.value + '!');
        document.compose.$Data{"TicketFreeTextField"}.focus();
        return false;
    }
<!-- dtl:block:TicketFreeTextCheckJs -->
<!-- dtl:block:TicketFreeTimeCheckJs -->
    if (document.compose.$Data{"TicketFreeTimeCheck"} && document.compose.$Data{"TicketFreeTimeCheck"}.checked == false) {
        alert('$JSText{"A required field is:"} $QData{"TicketFreeTimeKey"}!');
        document.compose.$Data{"TicketFreeTimeCheck"}.focus();
        return false;
    }
<!-- dtl:block:TicketFreeTimeCheckJs -->
<!-- dtl:block:TimeUnitsJs -->
    if (document.compose.TimeUnits.value != "") {
        var reg = /^-{0,1}\d+?((\.|,){0,1}\d+?){0,1}$/;
        if (reg.test(document.compose.TimeUnits.value) == false) {
            alert('$JSText{"Invalid time!"}');
            document.compose.TimeUnits.focus();
            return false;
        }
    }
    else if (document.compose.TimeUnits.value == "" && $Config{"Ticket::Frontend::NeedAccountedTime"}) {
        alert('$JSText{"You need to account time!"}');
        document.compose.TimeUnits.focus();
        return false;
    }
<!-- dtl:block:TimeUnitsJs -->

    if (document.getElementsByName('NewOwnerType').length) {
        // new owner
        if (document.getElementsByName('NewOwnerType').item(0).checked
            && document.compose.NewOwnerID.value == '') {

            alert('$JSText{"Please set a new owner!"}');
            return false;
        }
        // previous owner
        else if (document.getElementsByName('NewOwnerType').item(1).checked
            && document.compose.OldOwnerID.value == '') {

            alert('$JSText{"Please set a new owner!"}');
            return false;
        }
    }

	// MS_full
	var test = MS_Wind_Validate();
	if(!test)
	{
		if (document.compose.TicketFreeText10)
		{
			document.compose.TicketFreeText10.value = '';
		}

		if (document.compose.TicketFreeText11)
		{
			document.compose.TicketFreeText11.value = '';
		}
				
		return false;
	}
	// MS_full (fine)

    return true;
}
//-->
</script>

<script language="JavaScript" type="text/javascript">
<!--
function SpellCheckSubmit() {
    document.spelling.Body.value = document.compose.Body.value;
    window.open('', 'spelling', 'toolbar=no,location=no,status=yes,scrollbars=yes,resizable=yes,width=700,height=550,left=100,top=100');
    document.spelling.submit()
}
// -->
</script>

<!-- dtl:block:OwnerJs -->
<script language="JavaScript" type="text/javascript">
<!--
function change_selected(sel) {
    start_elements = (sel + 4);
    if (document.compose.elements[0].name == "$Config{"SessionName"}") {
        start_elements = start_elements + 1;
    }
    if (!document.compose.elements[start_elements].checked) {
        document.compose.elements[start_elements].checked = true;
    }
}
//-->
</script>
<!-- dtl:block:OwnerJs -->

<table border="0" width="100%" cellspacing="0" cellpadding="3">
    <tr>
        <td class="mainhead">
            $Env{"Box0"}$Text{"Change free text of ticket"}: $Data{"TicketNumber"}$Env{"Box1"}
        </td>
    </tr>
    <tr>
        <td class="menu">
<!-- dtl:block:TicketBack -->
            <a href="$Env{"Baselink"}$Env{"LastScreenView"}" onmouseover="window.status='$JSText{"Back"}'; return true;" onmouseout="window.status='';" class="menuitem">$Text{"Back"}</a>
<!-- dtl:block:TicketBack -->
<!-- dtl:block:PropertiesLock -->
            <img border="0" src="$Config{"Frontend::ImagePath"}warning.png" alt="$Text{"Info"}">: <font color="red">$Text{"Ticket locked!"}</font> (<a href="$Env{"Baselink"}Action=AgentTicketLock&Subaction=Unlock&TicketID=$Data{"TicketID"}" onmouseover="window.status='$JSText{"Ticket unlock!"}'; return true;" onmouseout="window.status='';">$Text{"Ticket unlock!"}</a>)
<!-- dtl:block:PropertiesLock -->
        </td>
    </tr>
    <tr>
        <td class="mainbody">
            <br/>
            <form action="$Env{"CGIHandle"}" method="post" enctype="multipart/form-data" name="compose">
                <input type="hidden" name="Action" value="$Env{"Action"}"/>
                <input type="hidden" name="Subaction" value="Store"/>
                <input type="hidden" name="TicketID" value="$QData{"TicketID"}"/>
                <input type="hidden" name="Expand" value=""/>
                <input type="hidden" name="FormID" value="$QData{"FormID"}"/>
                <table border="0" width="800" align="center" cellspacing="0" cellpadding="4">
                    <tr>
                        <td colspan="2" class="contenthead">$Text{"Options"}</td>
                    </tr>
                    <tr>
                        <td class="contentbody">
                            <table border="0" width="100%">
<!-- dtl:block:Title -->
                                <tr>
                                    <td colspan="2" width="20%" class="contentkey">$Text{"Title"}:</td>
                                    <td width="80%" class="contentvalue">
                                        <input type="text" name="Title" value="$QData{"Title"}" size="70"/>
                                        <font color="red" size="-2">$Text{"$Data{"Title invalid"}"}</font>
                                    </td>
                                </tr>
<!-- dtl:block:Title -->
<!-- dtl:block:Type -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Type"}:</td>
                                    <td class="contentvalue">$Data{"TypeStrg"}</td>
                                </tr>
<!-- dtl:block:Type -->
<!-- dtl:block:Service -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Service"}:</td>
                                    <td class="contentvalue">$Data{"ServiceStrg"} <font color="red" size="-2">$Text{"$Data{"Service invalid"}"}</font></td>
                                </tr>
<!-- dtl:block:Service -->
<!-- dtl:block:SLA -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"SLA"}:</td>
                                    <td class="contentvalue">$Data{"SLAStrg"} <font color="red" size="-2">$Text{"$Data{"SLA invalid"}"}</font></td>
                                </tr>
<!-- dtl:block:SLA -->
<!-- dtl:block:Owner -->
                                <tr>
                                    <td width="18%" class="contentkey">$Text{"New Owner"}:</td>
                                    <td width="2%" class="contentvalue">
                                        <input type="radio" name="NewOwnerType" value="New" $Data{"NewOwnerType::New"}/>
                                    </td>
                                    <td width="80%" class="contentvalue">$Data{"OwnerStrg"}</td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Previous Owner"}:</td>
                                    <td class="contentvalue">
                                        <input type="radio" name="NewOwnerType" value="Old" $Data{"NewOwnerType::Old"}/>
                                    </td>
                                    <td class="contentvalue">$Data{"OldOwnerStrg"}</td>
                                </tr>
<!-- dtl:block:Owner -->
<!-- dtl:block:Responsible -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Responsible"}:</td>
                                    <td class="contentvalue">$Data{"ResponsibleStrg"}</td>
                                </tr>
<!-- dtl:block:Responsible -->
<!-- dtl:block:Note -->
<!-- dtl:block:InformAgent -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Inform Agent"}: ($Text{"Optional"})</td>
                                    <td class="contentvalue">$Data{"OptionStrg"}</td>
                                </tr>
<!-- dtl:block:InformAgent -->
<!-- dtl:block:InvolvedAgent -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Inform involved Agents"}:</td>
                                    <td class="contentvalue">$Data{"InvolvedAgentStrg"}</td>
                                </tr>
<!-- dtl:block:InvolvedAgent -->
                                <tr>
                                    <td colspan="2" width="20%" class="contentkey">$Text{"Subject"}:</td>
                                    <td width="80%" class="contentvalue">
                                        <input type="text" name="Subject" value="$QData{"Subject"}" size="70"/>
                                        <font color="red" size="-2">$Text{"$Data{"Subject invalid"}"}</font>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Options"}:</td>
                                    <td class="contentvalue">
<!-- dtl:block:SpellCheck -->
                                        $Env{"Box0"}<a href="" onclick="SpellCheckSubmit(); return false;" onmouseover="window.status='$JSText{"Spell Check"}'; return true;" onmouseout="window.status='';"><img border="0" src="$Config{"Frontend::ImagePath"}spell.png">$Text{"Spell Check"}</a>$Env{"Box1"}
<!-- dtl:block:SpellCheck -->
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Text"}:</td>
                                    <td class="contentvalue">
                                        <div class="yui-skin-sam">
<!-- dtl:block:RichText -->
$Include{"RichTextEditor"}
<!-- dtl:block:RichText -->
                                            <textarea id="RichText" name="Body" rows="16" cols="$Config{"Ticket::Frontend::TextAreaNote"}">$QData{"Body"}</textarea>
                                            <font color="red" size="-2">$Text{"$Data{"Body invalid"}"}</font>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Attachment"}:</td>
                                    <td class="contentvalue">
                                        <table cellspacing="0" cellpadding="0" width="400">
<!-- dtl:block:Attachment -->
                                            <tr>
                                                <td>$QData{"Filename"}</td>
                                                <td>$QData{"Filesize"}</td>
                                                <td align="right">
                                                    <input class="button" type="submit" name="AttachmentDelete$QData{"FileID"}" value="$Text{"Delete"}"/>
                                                </td>
                                            </tr>
<!-- dtl:block:Attachment -->
                                            <tr>
                                                <td colspan="2"><input name="file_upload" type="file" size="40" class="fixed"/></td>
                                                <td align="right">
                                                    <input class="button" type="submit" name="AttachmentUpload" value="$Text{"Attach"}"/>
                                                    <a name="attachment"></a>
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                </tr>
<!-- dtl:block:ArticleType -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Note type"}:</td>
                                    <td class="contentvalue">$Data{"ArticleTypeStrg"}</td>
                                </tr>
<!-- dtl:block:ArticleType -->
<!-- dtl:block:Note -->
<!-- dtl:block:State -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Next state"}:</td>
                                    <td class="contentvalue">$Data{"StateStrg"}</td>
                                </tr>
<!-- dtl:block:StatePending -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Pending date"}:</td>
                                    <td class="contentvalue">$Data{"DateString"} <font color="red" size="-2">$Text{"$Data{"Date invalid"}"}</font></td>
                                </tr>
<!-- dtl:block:StatePending -->
<!-- dtl:block:State -->
<!-- dtl:block:Priority -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Priority"}:</td>
                                    <td class="contentvalue">$Data{"PriorityStrg"}</td>
                                </tr>
<!-- dtl:block:Priority -->
<!-- dtl:block:TicketFreeText -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Data{"TicketFreeKeyField"}:</td>
                                    <td class="contentvalue">$Data{"TicketFreeTextField"}</td>
                                </tr>
<!-- dtl:block:TicketFreeText -->
#<!-- dtl:block:TicketFreeText1 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Data{"TicketFreeKeyField1"}:</td>
#                  <td class="contentvalue">$Data{"TicketFreeTextField1"}</td>
#                </tr>
#<!-- dtl:block:TicketFreeText1 -->
#<!-- dtl:block:TicketFreeText2 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Data{"TicketFreeKeyField2"}:</td>
#                  <td class="contentvalue">$Data{"TicketFreeTextField2"}</td>
#                </tr>
#<!-- dtl:block:TicketFreeText2 -->
<!-- dtl:block:TicketFreeTime -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"$QData{"TicketFreeTimeKey"}"}:</td>
                                    <td class="contentvalue">$Data{"TicketFreeTime"}</td>
                                </tr>
<!-- dtl:block:TicketFreeTime -->
#<!-- dtl:block:TicketFreeTime1 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Text{"$Config{"TicketFreeTimeKey1"}"}:</td>
#                  <td class="contentvalue">$Data{"TicketFreeTime1"}</td>
#                </tr>
#<!-- dtl:block:TicketFreeTime1 -->
#<!-- dtl:block:TicketFreeTime2 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Text{"$Config{"TicketFreeTimeKey2"}"}:</td>
#                  <td class="contentvalue">$Data{"TicketFreeTime2"}</td>
#                </tr>
#<!-- dtl:block:TicketFreeTime2 -->
<!-- dtl:block:ArticleFreeText -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Data{"ArticleFreeKeyField"}:</td>
                                    <td class="contentvalue">$Data{"ArticleFreeTextField"}</td>
                                </tr>
<!-- dtl:block:ArticleFreeText -->
#<!-- dtl:block:ArticleFreeText1 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Data{"ArticleFreeKeyField1"}:</td>
#                  <td class="contentvalue">$Data{"ArticleFreeTextField1"}</td>
#                </tr>
#<!-- dtl:block:ArticleFreeText1 -->
#<!-- dtl:block:ArticleFreeText2 -->
#                <tr>
#                  <td colspan="2" class="contentkey">$Data{"ArticleFreeKeyField2"}:</td>
#                  <td class="contentvalue">$Data{"ArticleFreeTextField2"}</td>
#                </tr>
#<!-- dtl:block:ArticleFreeText2 -->
<!-- dtl:block:TimeUnits -->
                                <tr>
                                    <td colspan="2" class="contentkey">$Text{"Time units"}$Text{"$Config{"Ticket::Frontend::TimeUnits"}"}:</td>
                                    <td class="contentvalue"><input type="text" name="TimeUnits" value="$QData{"TimeUnits"}" size="3"/></td>
                                </tr>
<!-- dtl:block:TimeUnits -->






<!-- Wind (inizio) -->
                   <tr>
                        <td colspan="2" class="contentkey"> <br /> </td>
                        <td class="contentvalue"> <br /></td>
                    </tr>
                   <tr>
                        <td colspan="2" class="contentkey"> <br /> </td>
                        <td class="contentvalue"> <br /></td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"IMEI"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_IMEI" id="WIND_IMEI"  value="" size="30"/></td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"ID Linea"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_IDLINEA" id="WIND_IDLINEA" value="" size="30"/></td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"Ambito TT"}:</td>
                        <td class="contentvalue"> 
                        	<select name="WIND_AMBITOTT" id="WIND_AMBITOTT">
  								<option value="">-</option>
  							</select>
  						</td>
                    </tr>

                    <tr>
                        <td colspan="2" class="contentkey">$Text{"Tipo Linea"}:</td>
                        <td class="contentvalue"> 
                        	<select name="WIND_TIPOLINEA" id="WIND_TIPOLINEA">
  								<option value="">-</option>
  							</select>
  						</td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"MNP Type"}:</td>
                        <td class="contentvalue">
                        	<select name="WIND_MNPTYPE" id="WIND_MNPTYPE">
  								<option value="">-</option>
  							</select>
  						</td>
                    </tr>

                    <tr>
                        <td colspan="2" class="contentkey">$Text{"Indirizzo"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_INDIRIZZO" id="WIND_INDIRIZZO" value="" size="30"/></td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"Comune"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_COMUNE" id="WIND_COMUNE" value="" size="30"/></td>
                    </tr>
                    
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"Provincia"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_PROVINCIA" id="WIND_PROVINCIA" value="" size="30"/></td>
                    </tr>
                                        
                    <tr>
                        <td colspan="2" class="contentkey">$Text{"CAP"}:</td>
                        <td class="contentvalue"> <input type="text" name="WIND_CAP" id="WIND_CAP" value="" size="30"/></td>
                    </tr>
                    
<!-- Wind (fine) -->






                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="contentfooter">
                            <input class="button" id="submitRichText" accesskey="g" type="submit" value="$Text{"Submit"}" onclick="return submit_compose();"/>
                        </td>
                    </tr>
                </table>
            </form>
            <form action="$Env{"CGIHandle"}" method="post" name="spelling" target="spelling">
                <input type="hidden" name="Action" value="AgentSpelling"/>
                <input type="hidden" name="Body" value=""/>
                <input type="hidden" name="spell_lang" value=""/>
            </form>
            <br/>
        </td>
    </tr>
</table>
<!-- dtl:block:Properties -->
